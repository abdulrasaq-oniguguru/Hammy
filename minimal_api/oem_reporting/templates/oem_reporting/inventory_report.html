{% extends 'oem_reporting/base_oem.html' %}
{% load static %}
{% block title %}Inventory Report{% endblock %}

{% block extra_styles %}
<style>
    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        background: var(--bg-primary);
        color: var(--text-primary);
    }

    .mobile-report {
        max-width: 800px;
        margin: 0 auto;
        padding: 1rem;
    }

    .report-header {
        background: linear-gradient(135deg, #06d6a0 0%, #1b998b 100%);
        color: white;
        padding: 1.5rem;
        border-radius: 12px;
        margin-bottom: 1rem;
        text-align: center;
    }

    .report-header h1 {
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
    }

    .report-header .stats {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
        margin-top: 1rem;
    }

    .report-header .stat {
        background: rgba(255, 255, 255, 0.2);
        padding: 0.75rem;
        border-radius: 8px;
    }

    .report-header .stat p {
        font-size: 0.75rem;
        margin-bottom: 0.25rem;
        opacity: 0.9;
    }

    .report-header .stat h3 {
        font-size: 1.5rem;
        font-weight: 800;
    }

    .filter-card {
        background: var(--card-bg);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        padding: 1rem;
        margin-bottom: 1rem;
    }

    .filter-card h3 {
        font-size: 1.125rem;
        font-weight: 600;
        margin-bottom: 1rem;
        color: var(--text-primary);
    }

    .form-group {
        margin-bottom: 1rem;
    }

    .form-group label {
        display: block;
        font-size: 0.875rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
        color: var(--text-secondary);
    }

    .form-control, .form-select {
        width: 100%;
        padding: 0.75rem;
        border: 2px solid var(--border-color);
        border-radius: 8px;
        background: var(--input-bg);
        color: var(--text-primary);
        font-size: 1rem;
    }

    .btn {
        width: 100%;
        padding: 0.875rem;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
    }

    .btn-primary {
        background: linear-gradient(135deg, #06d6a0 0%, #1b998b 100%);
        color: white;
    }

    .btn-secondary {
        background: var(--bg-tertiary);
        color: var(--text-primary);
        margin-top: 0.5rem;
    }

    .product-item {
        background: var(--card-bg);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        padding: 1rem;
        margin-bottom: 1rem;
    }

    .product-item .product-name {
        font-size: 1.125rem;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 0.5rem;
    }

    .product-item .product-details {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 0.5rem;
        margin-bottom: 0.5rem;
    }

    .product-item .detail {
        font-size: 0.875rem;
        color: var(--text-secondary);
    }

    .product-item .detail strong {
        color: var(--text-primary);
    }

    .product-item .stock-badge {
        display: inline-block;
        padding: 0.25rem 0.75rem;
        border-radius: 20px;
        font-size: 0.875rem;
        font-weight: 600;
    }

    .stock-badge.good {
        background: rgba(6, 214, 160, 0.1);
        color: #06d6a0;
    }

    .stock-badge.low {
        background: rgba(255, 209, 102, 0.1);
        color: #f6c23e;
    }

    .stock-badge.critical {
        background: rgba(239, 71, 111, 0.1);
        color: #ef476f;
    }

    .empty-state {
        text-align: center;
        padding: 3rem 1rem;
        color: var(--text-secondary);
    }

    .back-link {
        display: block;
        text-align: center;
        padding: 1rem;
        color: var(--text-secondary);
        text-decoration: none;
        font-weight: 600;
    }

    @media (max-width: 768px) {
        .report-header h1 {
            font-size: 1.25rem;
        }

        .report-header .stat h3 {
            font-size: 1.25rem;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="mobile-report">
    <div class="report-header">
        <h1>üì¶ Inventory Report</h1>
        <div class="stats">
            <div class="stat">
                <p>Total Value</p>
                <h3>{{ currency_symbol }}{{ total_value|floatformat:0 }}</h3>
            </div>
            <div class="stat">
                <p>Low Stock</p>
                <h3>{{ low_stock_count }}</h3>
            </div>
        </div>
    </div>

    <div class="filter-card">
        <h3>üîç Search & Filters</h3>
        <form method="get">
            <div class="form-group">
                <label for="search">Search Products</label>
                <input type="text" name="search" id="search" class="form-control"
                       placeholder="Search by brand, barcode, category, size, color..."
                       value="{{ search_query }}">
            </div>

            <div class="form-group">
                <label for="category">Category</label>
                <select name="category" id="category" class="form-select">
                    <option value="">All Categories</option>
                    {% for value, label in categories %}
                        <option value="{{ value }}" {% if selected_category == value %}selected{% endif %}>{{ label }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label>
                    <input type="checkbox" name="low_stock" {% if show_low_stock %}checked{% endif %}>
                    Show Low Stock Only
                </label>
            </div>

            <button type="submit" class="btn btn-primary">Apply Filters</button>
            <a href="{% url 'oem_reporting:inventory_report' %}" class="btn btn-secondary">Clear</a>
        </form>
    </div>

    {% if products %}
        {% for product in products %}
            <div class="product-item">
                <div class="product-name">{{ product.brand|default:"Unnamed" }}</div>
                <div class="product-details">
                    <div class="detail">Category: <strong>{{ product.get_category_display|default:"N/A" }}</strong></div>
                    <div class="detail">Quantity: <strong>{{ product.quantity }}</strong></div>
                </div>
                <div>
                    {% if product.quantity < 5 %}
                        <span class="stock-badge critical">‚ö†Ô∏è Critical</span>
                    {% elif product.quantity < 10 %}
                        <span class="stock-badge low">‚ö° Low Stock</span>
                    {% else %}
                        <span class="stock-badge good">‚úì In Stock</span>
                    {% endif %}
                </div>
            </div>
        {% endfor %}
    {% else %}
        <div class="empty-state">
            <i class="bi bi-inbox"></i>
            <p>No products found.</p>
        </div>
    {% endif %}

    <a href="{% url 'oem_reporting:reports_menu' %}" class="back-link">
        ‚Üê Back to Reports
    </a>
</div>

{% endblock %}
